{% extends "base.html" %}

{% block title %}Просмотр логов - Crypto Playground{% endblock %}

{% block content %}
<div class="content-wrapper logs-page">
    <div class="page-header">
        <h1>Мониторинг процессов</h1>
        <p>Отслеживайте выполнение модулей и фоновых задач в реальном времени</p>
    </div>

    <div class="logs-layout">
        <aside class="logs-sidebar">
            <div class="logs-sidebar-header">
                <h2>Процессы</h2>
                <button id="refreshProcesses" class="icon-button" title="Обновить список">
                    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
                        <path d="M21 2v6h-6"/>
                        <path d="M3 12a9 9 0 0 1 14.9-6.4L21 8"/>
                        <path d="M3 22v-6h6"/>
                        <path d="M21 12a9 9 0 0 1-14.9 6.4L3 16"/>
                    </svg>
                </button>
            </div>

            <div class="logs-filters">
                <button class="filter-btn active" data-filter="all">Все</button>
                <button class="filter-btn" data-filter="running">Выполняются</button>
                <button class="filter-btn" data-filter="finished">Успешные</button>
                <button class="filter-btn" data-filter="failed">С ошибками</button>
            </div>

            <div id="processList" class="process-list">
                <div class="empty-message">
                    <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                        <path d="M3 3h18v18H3z" opacity="0.2"/>
                        <path d="M7 8h10"/>
                        <path d="M7 12h10"/>
                        <path d="M7 16h10"/>
                    </svg>
                    <p>Пока нет процессов. Запустите модуль или тестирование прокси.</p>
                </div>
            </div>
        </aside>

        <section class="logs-viewer">
            <div id="logsPlaceholder" class="logs-placeholder">
                <div class="empty-illustration">
                    <svg viewBox="0 0 24 24" width="56" height="56" aria-hidden="true">
                        <path d="M4 4h16v16H4z" opacity="0.1"/>
                        <path d="M8 2h8l4 4v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"/>
                        <path d="M9 12h6"/>
                        <path d="M9 16h6"/>
                    </svg>
                </div>
                <h2>Выберите процесс</h2>
                <p>Кликните по процессу слева, чтобы увидеть подробные логи и статистику выполнения.</p>
            </div>

            <div id="logsContent" class="logs-content" style="display: none;">
                <div class="logs-header">
                    <div class="logs-title">
                        <h2 id="logsCommandId">process</h2>
                        <span id="logsStatusBadge" class="status-badge">status</span>
                    </div>
                    <div class="logs-actions">
                        <button class="btn btn-secondary" id="downloadLogs">
                            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                <path d="M12 3v12"/>
                                <path d="M16 11l-4 4-4-4"/>
                                <path d="M20 18v1a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-1"/>
                            </svg>
                            Скачать логи
                        </button>
                        <button class="btn btn-secondary" id="stopProcess">
                            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                <rect x="6" y="6" width="12" height="12"/>
                            </svg>
                            Остановить
                        </button>
                        <button class="btn btn-danger" id="deleteProcess">
                            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                <path d="M3 6h18"/>
                                <path d="M8 6V4h8v2"/>
                                <path d="M19 6l-1 14H6L5 6"/>
                            </svg>
                            Удалить запись
                        </button>
                    </div>
                </div>

                <div class="logs-meta">
                    <div class="meta-item">
                        <span class="meta-label">Команда:</span>
                        <span id="logsCommand" class="meta-value">—</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">PID:</span>
                        <span id="logsPid" class="meta-value">—</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Начало:</span>
                        <span id="logsStarted" class="meta-value">—</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Завершение:</span>
                        <span id="logsFinished" class="meta-value">—</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Код выхода:</span>
                        <span id="logsExitCode" class="meta-value">—</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Количество записей:</span>
                        <span id="logsCount" class="meta-value">0</span>
                    </div>
                </div>

                <div id="processLogs" class="logs-output"></div>
            </div>
        </section>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/logs.js') }}"></script>
{% endblock %}
