{% extends "base.html" %}

{% block title %}Управление аккаунтами - Crypto Playground{% endblock %}

{% block content %}
<div class="content-wrapper accounts-page">
    <div class="page-header">
        <h1>Управление аккаунтами</h1>
        <p>Создавайте, редактируйте и импортируйте файлы аккаунтов для запуска модулей</p>
    </div>

    <div class="accounts-layout">
        <aside class="accounts-sidebar">
            <div class="accounts-sidebar-header">
                <h2>Файлы аккаунтов</h2>
                <button id="refreshAccountFiles" class="icon-button" title="Обновить список">
                    <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
                        <path d="M21 2v6h-6"/>
                        <path d="M3 12a9 9 0 0 1 14.9-6.4L21 8"/>
                        <path d="M3 22v-6h6"/>
                        <path d="M21 12a9 9 0 0 1-14.9 6.4L3 16"/>
                    </svg>
                </button>
            </div>

            <div class="accounts-actions">
                <div class="create-file-group">
                    <input type="text" id="newAccountFileName" class="form-control" placeholder="accounts.tsv">
                    <button class="btn btn-primary" id="createAccountFile">Создать</button>
                </div>

                <label class="upload-button">
                    <input type="file" id="uploadAccountFile" accept=".tsv,.txt,.csv">
                    <span class="upload-label">
                        <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                            <path d="M12 16V4"/>
                            <path d="M6 10l6-6 6 6"/>
                            <path d="M20 16v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2"/>
                        </svg>
                        Импортировать файл
                    </span>
                </label>
            </div>

            <div class="accounts-search">
                <input type="search" id="accountSearch" class="form-control" placeholder="Поиск по имени файла">
            </div>

            <div id="accountFilesList" class="accounts-file-list">
                <div class="empty-message">
                    <svg viewBox="0 0 24 24" width="32" height="32" aria-hidden="true">
                        <path d="M4 4h16v16H4z" opacity="0.2"/>
                        <path d="M8 2h8l4 4v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"/>
                        <path d="M9 12h6"/>
                        <path d="M9 16h6"/>
                    </svg>
                    <p>Файлы не найдены. Создайте новый или импортируйте существующий.</p>
                </div>
            </div>
        </aside>

        <section class="accounts-editor">
            <div id="accountsEmptyState" class="accounts-empty-state">
                <div class="empty-illustration">
                    <svg viewBox="0 0 24 24" width="56" height="56" aria-hidden="true">
                        <path d="M4 4h16v16H4z" opacity="0.1"/>
                        <path d="M8 2h8l4 4v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"/>
                        <path d="M12 11v6"/>
                        <path d="M9 14h6"/>
                    </svg>
                </div>
                <h2>Выберите файл</h2>
                <p>Нажмите на файл в списке слева, чтобы посмотреть содержимое и при необходимости изменить его.</p>
                <ul>
                    <li>Используйте табуляцию для разделения столбцов</li>
                    <li>Каждая строка соответствует отдельному аккаунту</li>
                    <li>Поддерживаются форматы TSV, TXT и CSV</li>
                </ul>
            </div>

            <div id="accountsEditorPanel" class="accounts-editor-panel" style="display: none;">
                <div class="editor-toolbar">
                    <div class="editor-meta">
                        <h2 id="editorFileName">accounts.tsv</h2>
                        <div class="editor-info">
                            <span id="editorRecordsCount">0 записей</span>
                            <span id="editorFileSize">0 байт</span>
                        </div>
                    </div>
                    <div class="editor-actions">
                        <button class="btn btn-secondary" id="downloadAccountFile">
                            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                <path d="M12 3v12"/>
                                <path d="M16 11l-4 4-4-4"/>
                                <path d="M20 18v1a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-1"/>
                            </svg>
                            Скачать
                        </button>
                        <button class="btn btn-secondary" id="renameAccountFile">
                            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/>
                                <path d="M14.06 4.94l3.75 3.75"/>
                            </svg>
                            Переименовать
                        </button>
                        <button class="btn btn-danger" id="deleteAccountFile">
                            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                <path d="M3 6h18"/>
                                <path d="M8 6V4h8v2"/>
                                <path d="M19 6l-1 14H6L5 6"/>
                            </svg>
                            Удалить
                        </button>
                    </div>
                </div>

                <textarea id="accountsEditor" class="accounts-textarea" rows="18" spellcheck="false"></textarea>

                <div class="editor-footer">
                    <div class="editor-status">
                        <span id="accountsDirtyBadge" class="status-badge" style="display: none;">Есть несохраненные изменения</span>
                    </div>
                    <div class="editor-buttons">
                        <button class="btn btn-secondary" id="revertAccountFile">Сбросить изменения</button>
                        <button class="btn btn-primary" id="saveAccountFile">Сохранить</button>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/accounts.js') }}"></script>
{% endblock %}
